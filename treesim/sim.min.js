!function(){const e=document.getElementById("simCanvas"),t=e.getContext("2d"),n={speed:1,branchChance:.02,branchAngle:18,wiggle:.1,gravity:0,taper:.95,initialWidth:12,minWidth:.5,segmentLength:5,seed:null},a={speed:document.getElementById("speed"),chance:document.getElementById("chance"),angle:document.getElementById("angle"),wiggle:document.getElementById("wiggle"),gravity:document.getElementById("gravity"),taper:document.getElementById("taper"),segmentLength:document.getElementById("segment-length"),seedInput:document.getElementById("seed"),seedLabel:document.getElementById("seed-label"),seedBtn:document.getElementById("seed-btn"),randomSeedBtn:document.getElementById("randomize-seed-btn"),btnStart:document.getElementById("btn-start"),btnReset:document.getElementById("btn-reset"),valSpeed:document.getElementById("val-speed"),valChance:document.getElementById("val-chance"),valAngle:document.getElementById("val-angle"),valWiggle:document.getElementById("val-wiggle"),valGravity:document.getElementById("val-gravity"),valTaper:document.getElementById("val-taper"),valSegmentLength:document.getElementById("val-segment-length"),statSegments:document.getElementById("segment-count"),statTips:document.getElementById("tip-count")};let l=[],i=[],d=!0,g=null,o=0;class s{constructor(e,t,n,a,l){this.x=e,this.y=t,this.angle=n,this.width=a,this.parentIndex=l,this.drawn=!1}}class h{constructor(e,t,n,a,l){this.x=e,this.y=t,this.angle=n,this.width=a,this.parentIndex=l}}let c=Math.random;function r(e){if(null===e||""===e)n.seed=null,c=Math.random,a.seedLabel&&(a.seedLabel.textContent="â€”");else{const t=Number(e)||0;n.seed=t,c=function(e){let t=e>>>0;return function(){t+=1831565813;let e=Math.imul(t^t>>>15,1|t);return e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296}}(t),a.seedLabel&&(a.seedLabel.textContent=String(t))}}function u(){e.width=window.innerWidth,e.height=window.innerHeight,!d&&l.length>0&&p()}function m(){l=[],i=[],o=0;const a=e.width/2,d=e.height;i.push(new h(a,d,-Math.PI/2,n.initialWidth,-1)),t.fillStyle="#1a1a1a",t.fillRect(0,0,e.width,e.height),y()}function p(){t.fillStyle="#1a1a1a",t.fillRect(0,0,e.width,e.height),t.lineCap="round",t.lineJoin="round";for(let e=0;e<l.length;e++){const n=l[e];if(-1===n.parentIndex)continue;const a=l[n.parentIndex],i=n.width,d=Math.max(30,Math.min(70,70-3*i));t.strokeStyle=`hsl(32, 60%, ${d}%)`,t.lineWidth=i,t.beginPath(),t.moveTo(a.x,a.y),t.lineTo(n.x,n.y),t.stroke()}}function y(){a.statSegments.textContent=l.length,a.statTips.textContent=i.length}a.speed.oninput=e=>{n.speed=parseFloat(e.target.value),a.valSpeed.textContent=n.speed},a.chance.oninput=e=>{n.branchChance=parseFloat(e.target.value),a.valChance.textContent=n.branchChance},a.angle.oninput=e=>{n.branchAngle=parseInt(e.target.value),a.valAngle.textContent=n.branchAngle},a.wiggle.oninput=e=>{n.wiggle=parseFloat(e.target.value),a.valWiggle.textContent=n.wiggle},a.gravity.oninput=e=>{n.gravity=parseFloat(e.target.value),a.valGravity.textContent=n.gravity},a.taper.oninput=e=>{n.taper=parseFloat(e.target.value),a.valTaper.textContent=n.taper},a.segmentLength.oninput=e=>{n.segmentLength=parseInt(e.target.value),a.valSegmentLength.textContent=n.segmentLength},a.seedBtn.onclick=()=>{const e=a.seedInput.value;r(""===e?null:Number(e)),m()},a.randomSeedBtn.onclick=()=>{const e=Math.floor(2147483647*Math.random());a.seedInput.value=e,r(e),m()},a.btnStart.onclick=()=>{d=!d,a.btnStart.textContent=d?"Pause":"Resume",a.btnStart.style.backgroundColor=d?"#4ade80":"#fbbf24",a.btnStart.style.color=d?"#003300":"#000"},a.btnReset.onclick=()=>{m(),d||p()},window.addEventListener("resize",u),u(),r(null),m(),function t(){d&&(!function(){if(d){for(o+=n.speed;o>=1&&(o-=1,0!==i.length);){let t=[];for(let a=0;a<i.length;a++){const d=i[a];if(d.width<n.minWidth||d.x<-50||d.x>e.width+50||d.y<-50||d.y>e.height+50)continue;const g=(c()-.5)*n.wiggle,o=c(),r=n.gravity;let u=d.angle+g+r;const m=d.x+Math.cos(u)*n.segmentLength,p=d.y+Math.sin(u)*n.segmentLength,y=l.length;if(l.push(new s(m,p,u,d.width,d.parentIndex)),o<n.branchChance){const e=n.branchAngle*Math.PI/180;t.push(new h(m,p,u-e,d.width*n.taper,y)),t.push(new h(m,p,u+e,d.width*n.taper,y))}else{const e=.999;t.push(new h(m,p,u,d.width*e,y))}}i=t}y()}}(),p()),g=requestAnimationFrame(t)}()}();